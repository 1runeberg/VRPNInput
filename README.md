# VRPNInput
This is a Unreal Engine 4 plugin that adds VRPN input to blueprints. We use it internally at the [University of Groningen Reality Theatre](http://www.rug.nl/science-and-society/centre-for-information-technology/research/hpcv/) and Cave.
As we only have VRPN Trackers and Buttons this plugin only supports those devices for now.

# Installation
You will need the VRPN library to compile this plugin. You can build it yourself or download it from the Github repository.
These are the steps I used to build the VRPN library for Windows and Linux.

1. Get the VRPN source at https://github.com/vrpn/vrpn
2. For Windows:
 * Use CMake to make Visual Studio 2013 project files for Windows.
 * Unchecked everything except VRPN_BUILD_CLIENT_LIBRARY.
 * Build the library. In the installation dir you will have an include and a lib directory with the nessesary files.
3. For Linux, this is the tricky part, I use the cross compile toolchain provided by Epic. But I have not managed to get CMake working with the toolchain so this is a bit hacky but it worked for me:
 * I have used the same vrpn_Configure.h file that was generated with CMake above to make sure that the library compiles with the same defines. So you need to replace that file with the one generated by CMake.
 * Copy Build/CrossCompile.bat to your VRPN library source directory and run it. You will have a linuxBuild directory with the files quat.a and vrpn.a.
 
After you build or downloaded the files you need to place the files in the right Unreal Engine directory:
* The VRPN library goes into UnrealEngine/Engine/Source/ThirdParty/VRPN
 * You will need to place the VRPN.Build.cs in that directory too.
 * The you should also have a directory 'include' where the VRPN headers go.
 * The libraries go into lib/linux and lib/win64.
* The plugin goes into Engine/Plugins

# Using the plugin
The plugin takes a .ini file that describes what VRPN devices there are and how to map them to the input.
The reason we use .ini files is that this way we can switch or remap VRPN devices without repackaging the project.
You will need to start both the editor and the package game with a -VRPNConfigFile="absolute_path_to_.ini" command line option.
If you forget to start the package and forget to specify the .ini file you will get lots of warnings in your log file but the game will run.
If you open a project and forget to specify the option you will get a lot of warnings when trying to compile blueprints that make use of events coming from VRPN devices.

The plugin is very verbose, if something is not working search the log file for the phrase LogVRPNInputDevice to see what the problem is.
All the VRPN library error messages are written to the command line.

# Todo:
* Add more VRPN devices
* Add a way to bind custom c++ functions. (first check if UE4 doesn't have that option already for the event system)
* The plugin needs to be pointed to a .ini file right now (both in editor and in packaged game). This happends with a command line option and is not ideal.
 * Have a standard .ini location and have the command line option only as override.
 * Carry changed to the .ini file with the packaged game. Right now you need to manually copy the .ini file and use the command line option to point to it.
 * During packaging some scripts don't load the .ini (or the plugin?) and produce warnings about blueprint events not found.
 * Have a tool in the editor to edit the VRPN devices.
* Error messages are now written to the command line, intercept them and write them to the UE4 log.
